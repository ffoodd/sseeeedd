{% extends "index.html" %}

{% block navigation %}
  <ul class="fly-out">
    <li><a href="./index.html">Accueil</a></li>
    <li><a href="./atomes.html">Atomes</a></li>
    <li>
      <a aria-current="page">Molécules</a>
      <ul>
        <li><a href="./molecules.html#messages">Messages</a></li>
        <li><a href="./molecules.html#cards">Cartes</a></li>
        <li><a href="./molecules.html#panels">Panneaux</a></li>
        <li><a href="./molecules.html#codeblocks">Blocs de code</a></li>
        <li><a href="./molecules.html#fly-out">Menu déroulant</a></li>
        <li><a href="./molecules.html#charts">Graphiques</a></li>
      </ul>
    </li>
  </ul>
{% endblock %}

{% block main %}
  <h1>Molécules</h1>
  
  <p>Les molécules sont les éléments d’interface de complexité intermédiare.</p>
  
  <h2 id="messages">Messages</h2>
  
  <p>
    Les boîtes de message respectent le motif de conception <abbr lang="en" title="Accessible Rich Internet Application">aria</abbr> 
    associé. Pour vous en servir correctement, deux conditions&nbsp;:
  </p>
  
  <ol>
    <li>
      la <code>div role="alert" aria-live="assertive"</code> doit être présente mais vide dans le code source 
      dès le chargement de la page&nbsp;;
    </li>
    <li>
      lors de l’affichage d’un message, vous devez modifier son contenu <abbr lang="en" title="HyperText Markup Language">html</abbr>, 
      de préférence avec la méthode JavaScript <code>.innerHTML()</code>.
    </li>
  </ol>
  
  {% set messages = ['alert','success','accent','dominant','secondary'] %}
  {% for message in messages %}
   <div role="alert" aria-live="assertive" class="alert bg-{{ message }}">
     <p>Oh, le joli message&nbsp;!</p>
   </div>
  {% endfor %}
  
  <h2 id="cards">Cartes</h2>
  
  <p>
    Un système de grille basique mais efficace est disponible.
    La version de base repose sur les <strong>colonnes</strong> <abbr lang="en" title="Cascading StyleSheet">css</abbr> 
    —&nbsp;supportées depuis <abbr lang="en" title="Internet Explorer">ie</abbr>10&nbsp;— et la grille fixe
    s’appuie sur les <strong>grilles</strong> CSS (sans préfixes Microsoft, mais avec une bascule sur les colonnes pour les navigateurs intermédiaires).
  </p>
  
  {% import 'macros/_cards.html' as cards %}
  
  <h3>En colonnes</h3>

  <div class="columns-3">
    {{ cards.card() }}
    {{ cards.card('-dominant', 'true', '', '') }}
    {{ cards.card('-success', '', 'true', '') }}    
    {{ cards.card('-accent') }}
    {{ cards.card('', '', 'true', 'true') }}
    {{ cards.card('-alert', '', 'true', '') }}
    {{ cards.card('', '', 'true', 'true') }}
    {{ cards.card('-secondary') }}
  </div>
  
  <h3>En grille fixe</h3>
  
  <div class="grid-3">
    {{ cards.card() }}
    {{ cards.card('-dominant') }}
    {{ cards.card('-success') }}    
    {{ cards.card('-accent') }}
    {{ cards.card() }}
    {{ cards.card('-alert') }}
    {{ cards.card() }}
    {{ cards.card('-secondary') }}
  </div>
  
  <h2 id="panels">Panneaux</h2>
  
  <p>
    Les panneaux sont les éléments HTML5 natifs <code>details</code> et <code>summary</code>.
    Ces éléments travaillent conjointement pour composer un élément interactif permettant d’afficher 
    du contenu supplémentaire.
    <br>
    Ils sont par conséquents accessibles et se dégradent gracieusement sur les navigateurs ne les supportant pas.
  </p>
  
  {% set panneaux = [1,2,3,4] %}
  {% for panneau in panneaux %}
    <details>
      <summary>Panneau №{{ loop.index }}</summary>
      <div>
        <h3>Contenu №{{ loop.index }}</h3>
        <p>
          Au fond de la darse s’amorce une seconde ligne de trams qui longe le bord de la mer.
          <small>Le tram se compose de six cars, où nombre de voyageurs ont déjà pris place.</small>
          Ces cars sont traînés par <strong>une locomotive électrique</strong>, avec <mark>accumulateurs</mark> d’une capacité de deux cents ampères-ohms,
          et leur <a href="https://fr.wikipedia.org/wiki/Vitesse">vitesse</a> atteint de quinze à <del>dix-huit</del> <ins>dix-neuf</ins> kilomètres.
        </p>
      </div>
    </details>
  {% endfor %}
  
  <h3>Panneaux verticaux</h3>
  
  <p>
    Les panneaux verticaux sont une version enrichie des panneaux ordinaires.
    Ils s’appuient sur <code>flexbox</code> et un bout de JavaScript, pour s’assurer qu’un seul panneau soit déplié à la fois.
    L’orientation verticale du texte dépend du support de la propriété CSS <code>writing-mode</code>.
  </p>
  
  <div class="vertical">
    {% for panneau in panneaux %}
      <details {% if loop.index == 1%}open{% endif %}>
        <summary>Panneau №{{ loop.index }}</summary>
        <div>
          <h3>Contenu №{{ loop.index }}</h3>
          <p>
            Au fond de la darse s’amorce une seconde ligne de trams qui longe le bord de la mer.
            <small>Le tram se compose de six cars, où nombre de voyageurs ont déjà pris place.</small>
            Ces cars sont traînés par <strong>une locomotive électrique</strong>, avec <mark>accumulateurs</mark> d’une capacité de deux cents ampères-ohms,
            et leur <a href="https://fr.wikipedia.org/wiki/Vitesse">vitesse</a> atteint de quinze à <del>dix-huit</del> <ins>dix-neuf</ins> kilomètres.
          </p>
        </div>
      </details>
    {% endfor %}
  </div>
  
  <h2 id="codeblocks">Blocs de code</h2>
  
  <p>
    Les blocs de code ont un habillage personnalisé, imitant sommairement une fenêtre système.
    <strong>PrismJS</strong>, un script de coloration syntaxique supportant plusieurs langages, est présent
    —&nbsp;avec un thème personnalisé aux couleurs de WAF.
  </p>
  
  <pre><code class="language-css">.open-space {
  display: grid;
  grid-template: repeat(16, minmax(3rem, 1fr)) / repeat(44, minmax(calc(3rem * 4 / 3), 1fr));
  height: 100vh;
  position: fixed;
  width: 100vw; 
}</code></pre>

  <h2 id="fly-out">Menu déroulant</h2>
  
  <p>
    Là, ça devient rigolo.
    <br>
    Ces menus déroulants <strong>fonctionnent sans JavaScript</strong> et sont parfaitement <strong>accessibles</strong>. Ils sont cependant
    limités à un seul niveau. Si vous avez besoin de plusieurs niveaux imbriqués, préférez une solution basée sur JavaScript.
    <br>
    Ce composant requiert le support de&nbsp;:
  </p>
  
  <ul>
    <li><code>clip-path</code> pour le masquage du sous-menu et ses effets d’apparition&nbsp;;</li>
    <li><code>:focus-within</code> pour maintenir le menu ouvert tant qu’un élément enfant a le <em lang="en">focus</em>.</li>
  </ul>
  
  <p>
    On pourrait tout à fait bricoler une version dégradée de <code>clip-path</code> en utilisant <code>clip</code>, cependant
    le support de <code>:focus-within</code> nécessite un <em lang="en">polyfill</em> en JavaScript (qui n’est pas inclus pour le moment).
    Un délai de 300&nbsp;<abbr title="Milliseconde">ms</abbr> est laissé avant de refermer le menu, pour éviter les fermetures intempestives et non désirées.
  </p>

  <ul class="fly-out">
    <li>
      <a href="./">Niveau 1</a>
      <ul>
        <li><a href="./">Niveau 2</a></li>
        <li><a href="./">Niveau 2</a></li>
        <li><a href="./">Niveau 2</a></li>
      </ul>
    </li>
    <li><a href="./">Niveau 1</a></li>
    <li>
      <a href="./">Niveau 1</a>
      <ul>
        <li><a href="./">Niveau 2</a></li>
        <li><a href="./">Niveau 2</a></li>
        <li><a href="./">Niveau 2</a></li>
      </ul>
    </li>
  </ul>

  <h2 id="charts">Graphiques</h2>
  
  <p>
    Les deux versions de graphiques présentées pour le moment reposent uniquement sur un balisage sémantique
    —&nbsp;<code>dl</code>, <code>dt</code> et <code>dd</code>&nbsp;— et une tartine de <strong>variables CSS portées par les balises</strong>.
  </p>
  
  <p>
    Là encore, le balisage est parfaitement accessible&nbsp;! Aucun JavaScript n’est requis, et les styles proposent une 
    <strong>amélioration progressive</strong> selon les capacités de votre navigateur.
  </p>

  <h3>Graphique en barre</h3>
  
  <p>
    Ce type de graphique sert à représenter <strong>des données à une dimension</strong> (dans notre exemple, une ligne de temps).
    Il repose sur les <strong>grilles et les variables CSS</strong>.
    Pour vous en servir, c’est simple&nbsp;:
  </p>
  
  <ol>
    <li>
      Pour améliorer la compréhension globale, utiliser un <strong>conteneur</strong> <code>figure</code> avec le role <code>group</code> ainsi 
      qu’une légende balisée avec <code>figcaption</code>.
    </li>
    <li>
      Sur la <strong>liste de définitions</strong> <code>dl</code>, une variable <code>--scale</code> permet de définir la valeur maximale du graphique,
      afin d’en déterminer l’échelle. Concrètement, une grille va être générée avec&nbsp;:
      <ul>
        <li>la première colonne pour les termes <code>dt</code> arbitrairement fixée à <code>12.5em</code>&nbsp;;</li>
        <li>puis la fonction CSS <code>repeat()</code> crée une colonne par unité de l’échelle —&nbsp;dans l’exemple, 3000 colonnes&nbsp;;</li>
        <li>enfin une dernière colonne mesurant <code>6ch</code>, soit l’espace suffisant pour six lettres.</li>
      </ul>
    </li>
    <li>
      <strong>Sur chaque définition</strong> <code>dd</code>, une variable <code>--value</code> permet de la placer sur la grille, 
      appliquée à <code>grid-column-end</code>.
      De plus grâce à de savants calculs reposant sur cette valeur, le dégradé en arrière-plan est dimensionné et positionné de façon à
      refléter la proportion représentée par cette valeur sur l’échelle donnée (du vert pour presque rien au rouge pour presque tout).
    </li>
    <li>
      <strong>Dans chaque définition</strong>, le contenu doit reprendre la valeur dans un élément <code>span</code> et une unité, éventuellement 
      balisée avec <code>abbr</code> si un intitulé peut être explicité pour l’unité. Cette valeur est poussée à droite de la grille, et son texte 
      sert de masque pour le dégradé en arrière-plan —&nbsp;lui permettant d’être de la couleur correspondante à la fin du dégradé pour la position donnée.
    </li>
  </ol>
  
  {% import 'macros/_bar.html' as charts %}

  <figure role="group">
    <dl class="charts-bar" style="--scale: 3000">
      {{ charts.bar('Temps : backend', '4', 'ms', 'Milliseconde') }}
      {{ charts.bar('Temps : Frontend', '96', 'ms', 'Milliseconde') }}
      {{ charts.bar('Délai : premier octet', '102', 'ms', 'Milliseconde') }}
      {{ charts.bar('Délai : dernier octet', '129', 'ms', 'Milliseconde') }}
      {{ charts.bar('Délai : première image', '188', 'ms', 'Milliseconde') }}
      {{ charts.bar('Délai : premier CSS', '194', 'ms', 'Milliseconde') }}
      {{ charts.bar('Délai : premier JS', '326', 'ms', 'Milliseconde') }}
      {{ charts.bar('DOM Interactif', '836', 'ms', 'Milliseconde') }}
      {{ charts.bar('Chargement du DOM', '836', 'ms', 'Milliseconde') }}
      {{ charts.bar('DOM complet', '2561', 'ms', 'Milliseconde') }}
      {{ charts.bar('Trafic HTTP terminé', '2980', 'ms', 'Milliseconde') }}
    </dl>
    <figcaption>Temps de chargement pour <a href="https://www.ffoodd.fr" target="_blank" rel="noopener noreferrer">ffoodd.fr</a></figcaption> 
  </figure>

  <h3>Graphique en tarte</h3>
  
  <p>
    Le graphique en tarte sert pour <strong>les représentations de proportions</strong>, généralement en pourcentage.
    Il utilise principalement les variables CSS, <code>flexbox</code>, <code>clip-path</code>, <code>transform</code> et un tantinet de 
    <abbr lang="en" title="Scalable Vectors Graphics">SVG</abbr> pour distinguer chaque zone. Oui, je sais rigoler. Comment qu’on s’en sert&nbsp;?
  </p>
  
  <ol>
    <li>
      Comme pour le précédent exemple&nbsp;: pour améliorer la compréhension globale, utiliser un <strong>conteneur</strong> <code>figure</code> avec le role <code>group</code> ainsi 
      qu’une légende balisée avec <code>figcaption</code>.
    </li>
    <li>
      Sur la <strong>liste de définitions</strong> <code>dl</code>, une variable <code>--offset</code> permet de déterminer la dimension du trou du <em lang="en">donut</em>.
      Si, si, on en avait besoin&nbsp;!
    </li>
    <li>
      <strong>Sur chaque terme</strong> <code>dt</code>, une variable <code>--color</code> permet d’attribuer, et bien… une couleur.
    </li>
    <li>
      <strong>Pour chaque terme</strong> <code>dt</code>, deux définitions <code>dd</code> doivent suivre&nbsp;:
      <ol>
        <li>la première doit contenir la valeur et son unité, et porter la même variable <code>--color</code> que son terme&nbsp;;</li>
        <li>
          la seconde est là où la magie opère&nbsp;:
          <ul>
            <li>Avant tout, comme il s’agit d’un élément purement visuel on lui affuble un rôle <code>presentation</code>.</li>
            <li>
              Puis <strong>trois variables</strong> permettent de le placer et le colorer fidèlement à la définition fournie&nbsp;: <code>--value</code>, <code>--start</code> et <code>--color</code>.
              <code>--value</code> correspond à la valeur en pourcentage, utile pour déterminer <strong>l’angle de rotation</strong> de l’arc correspondant.
              <code>--start</code> permet de définir le <strong>point de départ</strong> de l’arc sur le cercle. Il s’agit de la somme des précédentes définitions, celle-ci incluse.
              Et <code>--color</code>… Ne me faites pas répéter&nbsp;!
          </ul>
        </li>
      </ol>
    </li>
    <li>Et finalement un motif est appliqué sur l’arrière-plan, afin de mieux l’associer visuellement avec la légende correspondante.</li>
  </ol>
  
  {% import 'macros/_pie.html' as charts %}

  <figure role="group">
    <dl class="charts-pie" style="--offset: 8rem">
      {{ charts.pie('HTML', '2', '%', '', '0', '#444') }}
      {{ charts.pie('CSS', '2', '%', '', '2', 'firebrick') }}
      {{ charts.pie('JS', '32', '%', '', '4', 'crimson') }}
      {{ charts.pie('Json', '1', '%', '', '36', 'mediumblue') }}
      {{ charts.pie('Images', '44', '%', '', '37', 'darkblue') }}
      {{ charts.pie('Webfonts', '17', '%', '', '81', 'rebeccapurple') }}
      {{ charts.pie('Autres', '2', '%', '', '98', 'indigo') }}
    </dl>
    <figcaption>Répartition du poids des ressources pour <a href="https://www.ffoodd.fr" target="_blank" rel="noopener noreferrer">ffoodd.fr</a></figcaption>
  </figure>
  
{% endblock %}