@charset "UTF-8";

/* ----------------------------- */
/* Table of contents */
/* ----------------------------- */
/*
  == Imports
  == Base
  == Helpers
     -- Improved sr-only
  == Typography
  == Images
  == Tables
  == Details
  == Grid
  == Forms
  == Components
    -- Navigation
    -- Header
    -- Footer
*/

/* ==================== */
/* == Imports
/* ==================== */

@import "utilities/mixins";
@import "utilities/functions";
@import "utilities/variables";

@import "dependencies/normalize";
@import "dependencies/formage-variables";
@import "dependencies/formage-dependencies";
@import "dependencies/formage";
@import "dependencies/prism";


/* ==================== */
/* == Base
/* ==================== */

/**
 * @note Some improvements taken from Ergonomize.css
 * @author Effeilo
 - @see https://github.com/Effeilo/ergonomize.css/blob/master/ergonomize.css
 * 1. Force scrollbars to always be visible to prevent awkward jumps when
 *    navigating between pages that do/do not have enough content to produce
 *    scrollbars naturally.
 * 2. For some Firefox.
 *    css-tricks.com/snippets/css/force-vertical-scrollbar/
 */
html[lang] {
  box-sizing: border-box;
  overflow-y: scroll;                 /* 1 */
  overflow: -moz-scrollbars-vertical; /* 2 */
  position: relative;
}

*,
*::after,
*::before {
  box-sizing: inherit;
}

body {
  background: palette( default, secondary );
  color: palette( dominant );
  counter-reset: footnotes;
  font: normal 400 1em/1.5 sans-serif;
  font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Oxygen-Sans, Ubuntu, Cantarell, "Helvetica Neue", sans-serif;
  overflow-x: hidden;
  position: relative;
  -webkit-font-smoothing: subpixel-antialiased;
  text-rendering: optimizeSpeed;
}

/**
 * @note Selection
 * @see https://developer.mozilla.org/en-US/docs/Web/CSS/::selection
 * 1. Shadow is required for fake underlines
 */
::selection {
  background-color: palette( secondary );
  color: palette( default, secondary );
  text-shadow: none;
}

a {
  color: palette( accent );
  text-decoration-style: dotted;
  text-decoration-skip-ink: auto;

  &:hover,
  &:focus {
    color: palette( accent, dark );
  }

  &:active,
  &:visited {
    opacity: .75;
  }
  
  &[target$="blank"]::after {
    content: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='#{$blank}' height='10' width='10' viewBox='0 0 100 100'%3E%3Cpath d='M91.875 62H85v23H15V15h23V0H0v100h100V62z'/%3E%3Cpath d='M54 0v.627l17.787 17.85L52.701 38H38v24h24V49.799l20.773-20.337L99.374 46H100V0z'/%3E%3C/svg%3E");
    padding-left: .25em;
  }
  
  &:hover[target$="blank"]::after,
  &:focus[target$="blank"]::after {
    content: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' fill='#{$blank-focus}' height='10' width='10' viewBox='0 0 100 100'%3E%3Cpath d='M91.875 62H85v23H15V15h23V0H0v100h100V62z'/%3E%3Cpath d='M54 0v.627l17.787 17.85L52.701 38H38v24h24V49.799l20.773-20.337L99.374 46H100V0z'/%3E%3C/svg%3E");
  }
}

main address {
  font-size: em( 22 );
  font-style: normal;
  padding: 0 0 0 2em;
}

code,
pre,
video,
svg {
  max-width: 100%;
}

li {
  p,
  ul,
  ol {
    margin-bottom: 0;
    margin-top: 0;
  }
}

[hidden],
[role="alert"]:empty {
  display: none;
}

main {
  margin: 0 auto;
  outline: none;
}


/* ==================== */
/* == Helpers
/* ==================== */

.no-margin {
  margin: 0 !important;
}

.no-padding {
  padding: 0 !important;
}

.no-border {
  border: 0 !important;
}

.no-list {
  list-style: none !important;
  padding: 0;
}

/* Sizing */
[class*="--s"] {
  font-size: em( 14 );
  line-height: 1.5;
}

[class*="--l"] {
  font-size: em( 20 );
  line-height: 1.2;
}

[class*="--xl"] {
  font-size: em( 30 );
  line-height: 1.6;
  margin: em( 36, 30 ) 0;
}

/* Colors */
.muted {
  color: palette( muted ) !important;

  em,
  strong {
    color: palette( default, secondary );
  }
}


/* ----------------------------- */
/* -- Improved sr-only
/* ----------------------------- */
/*
 * @author Gaël Poupard
 ** @note Based on Yahoo!'s technique
 ** @author Thierry Koblentz
 ** @see https://developer.yahoo.com/blogs/ydn/clip-hidden-content-better-accessibility-53456.html
 ** 1.
 *** @note `clip` is deprecated but works everywhere
 *** @see https://developer.mozilla.org/en-US/docs/Web/CSS/clip
 ** 2.
 *** @note `clip-path` is the future-proof version, but not very well supported yet
 *** @see https://developer.mozilla.org/en-US/docs/Web/CSS/clip-path
 *** @see http://caniuse.com/#search=clip-path
 *** @author Yvain Liechti
 *** @see https://twitter.com/ryuran78/status/778943389819604992
 ** 3.
 *** @note preventing text to be condensed
 *** author J. Renée Beach
 *** @see https://medium.com/@jessebeach/beware-smushed-off-screen-accessible-text-5952a4c2cbfe
 *** @note Drupal 8 goes with word-wrap: normal instead
 *** @see https://www.drupal.org/node/2045151
 *** @see http://cgit.drupalcode.org/drupal/commit/?id=5b847ea
 ** 4.
 *** @note !important is important
 *** @note Obviously you wanna hide something
 *** @author Harry Roberts
 *** @see http://csswizardry.com/2016/05/the-importance-of-important/
 */
.sr-only {
	border: 0 !important;
	clip: rect(1px, 1px, 1px, 1px) !important; /* 1 */
	clip-path: inset(50%) !important;  /* 2 */
	height: 1px !important;
	overflow: hidden !important;
	padding: 0 !important;
	position: absolute !important;
	width: 1px !important;
	white-space: nowrap !important;            /* 3 */
}

/*
 * Use in conjunction with .sr-only to only display content when it's focused.
 ** @note Useful for skip links
 ** @see http://www.w3.org/TR/2013/NOTE-WCAG20-TECHS-20130905/G1
 ** @note Based on a HTML5 Boilerplate technique, included in Bootstrap
 */
.sr-only-focusable:focus,
.sr-only-focusable:active {
	clip: auto !important;
	clip-path: none !important;
	height: auto !important;
	overflow: visible !important;
	width: auto !important;
	white-space: normal !important;
}

/**
 * Aliasing .sr-only
 * @note To match H5BP, Foundation, and Formage
 */
.visually-hidden {
  @extend .sr-only;
}



/* ==================== */
/* == Typography
/* ==================== */
p,
ul,
ol,
dl,
pre,
td,
th,
caption {
  font-size: em( 16 );
  line-height: 1.5;
  margin: em( 24 ) 0;
}

.hn {
  color: palette( dominant, dark );
  font-weight: 700;
  -webkit-font-smoothing: antialiased;
  -moz-osx-font-smoothing: grayscale;
  text-rendering: optimizelegibility;
}

h1,
.h1 {
  color: palette( secondary );
  font-size: em( 46 );
  line-height: 1.0434;
  margin:  em( 48, 46 ) 0 em( 24, 46 );
  @extend .hn;

  strong {
    color: palette( dominant );
  }
}

h2,
.h2 {
  color: palette( accent );
  font-size: em( 40 );
  line-height: 1.2;
  margin: em( 48, 40 ) 0 em( 24, 40 );
  @extend .hn;
}

h3,
.h3 {
  color: palette( dominant );
  font-size: em( 36 );
  line-height: 1.3334;
  margin: em( 48, 36 ) 0 em( 24, 36 );
  @extend .hn;
}

h4,
.h4 {
  font-size: em( 30 );
  line-height: 1.6;
  margin: em( 48, 30 ) 0 em( 24, 30 );
  @extend .hn;
}

h5,
.h5 {
  font-size: em( 26 );
  line-height: 1.8462;
  margin: em( 48, 26 ) 0 em( 24, 26 );
  @extend .hn;
}

h6,
th,
.h6 {
  font-size: em( 22 );
  line-height: 1.0909;
  margin: em( 48, 22 ) 0 em( 24, 22 );
  @extend .hn;
}

textarea,
table,
td,
th,
div,
p {
  word-wrap: break-word;
  hyphens: auto;
}

blockquote {
  font-size: em( 16 );
  font-style: italic;
  line-height: 1.5;
  margin: em( 48 ) 0 em( 24 );
  max-width: 100%;
  padding-left: em( 112 );
  position: relative;
  quotes: "«\00A0" "\00A0»";
  z-index: 2;

  &::before {
    color: palette( muted, light );
    content: open-quote;
    font-size: em( 160 );
    font-weight: 700;
    left: 0;
    line-height: 0;
    opacity: .25;
    position: absolute;
    top: 0;
    z-index: -1;
  }

  footer {
    font-style: normal;
    @extend .hn;
  }
}

abbr[title] {
  border-bottom: 1px dotted;
  cursor: help;
  text-decoration: none;
  text-transform: uppercase;
}

small,
.small {
  font-size: em( 14 );
}

b,
dt,
strong {
  @extend .hn;
}

cite {
  color: palette( accent );
  font-style: normal;
  @extend .hn;
}

hr {
  border-bottom: 1px solid white;
  border-top: 1px solid transparentize( palette( muted, light ), .5 ); 
  height: 0;
}

code {
  font: inherit;
  line-height: 1;
}

pre {
  background: palette( dominant );
  border: 0;
  border-radius: em( 4 );
  color: palette( dominant, contrast );
  direction: ltr;
  font-family: "Fira Mono", "Consolas", "Monaco", "Andale Mono", monospace;
  font-size: small;
  line-height: 1.5;
  hyphens: none;
	tab-size: 4;
  overflow-x: auto;
  padding: em( 32 ) em( 16 ) em( 8 );
  text-align: left;
  white-space: pre;
  word-break: normal;
  word-spacing: normal;
  word-wrap: normal;
  
  &::before {
    background: palette( alert );
    border-radius: 50%;
    box-shadow: em( 24 ) 0 0 0 Orange,
                em( 48 ) 0 0 0 palette( success );
    content: "";
    display: block;
    height: 1rem;
    transform: translateY( -1rem );
    width: 1rem;
  }
}

p code,
ul code,
ol code {
  border: 1px solid;
  border-radius: .2em;
  color: palette( secondary );
  display: inline-block;
  font-family: inherit;
  padding: .1em;
  white-space: nowrap;
}


/* ==================== */
/* == Images
/* ==================== */

/**
 * 1. DIsplay something if source is unreachable
 * @see http://bitsofco.de/styling-broken-images/
 * 2. This is a line break, like \n.
 * 3. attr() functions returns attribute value, only in content property for now
 * 4. And \A0 is a non-breakable space.
 */
img[alt] {
  display: inline-block;
  max-width: 100%;
  position: relative;
  vertical-align: middle;

  &:not([src$=".svg"]) {
    min-height: em( 64 );
    height: auto;
  }

  /* 1 */
  &::after {
    background: white;
    bottom: 0;
    content:
      attr( alt )         /* 3 */
      "\A"                /* 2 */
      "—\A0" attr( src ); /* 4 */
    left: 0;
    padding: em( 8 );
    position: absolute;
    top: 0;
    width: 100%;
    white-space: pre-wrap;
  }
}

svg {
  fill: currentColor;
}

figure[role="group"] {
  background: white;
  margin: em( 24 ) auto;
  padding: em( 16 );

  figcaption {
    display: block;
    font-size: em( 14 );
    padding: 1em 0;
  }
}


/* ==================== */
/* == Tables
/* ==================== */

/**
 * 1. @note Scrollable tables
 * @author David Bushell
 * @see http://dbushell.com/2016/03/04/css-only-responsive-tables/
 * @see http://codepen.io/dbushell/full/8e6a1ee85418f3c5abe839647dbcdec5/
 */
table {
  border-collapse: collapse;
  caption-side: top;
  display: inline-block; /* 1 */
  margin-bottom: em( 24 );
  max-width: 100%;
  overflow-x: auto;      /* 1 */
  vertical-align: top;
  white-space: nowrap;   /* 1 */

  > caption:first-child {
    font-style: italic;
    margin: 0;
    padding: em( 40 ) em( 16 );
  }
}

th,
td {
  padding: em( 8 ) em( 12 );
  text-align: left;

  thead &,
  tbody & {
    border-bottom: 1px solid palette( default, secondary );
  }
}

td {
  line-height: 1.25;
  max-width: 100%;
}

tbody {
  border: 1px solid palette( default, secondary );

  tr > * + * {
    border-left: 1px solid palette( default, secondary );
  }
}

/**
 * @note Scrollable tables's shadows on scroll
 * @author David Bushell
 * @see http://dbushell.com/2016/03/04/css-only-responsive-tables/
 * @see http://codepen.io/dbushell/full/8e6a1ee85418f3c5abe839647dbcdec5/
 */
@media only screen and (max-width: em( 768 )) {
  table {
    background:
      radial-gradient(
          ellipse at left,
          rgba(0, 0, 0, 0.2) 0%,
          rgba(0, 0, 0, 0) 75%) 0 center,
      radial-gradient(
          ellipse at right,
          rgba(0, 0, 0, 0.2) 0%,
          rgba(0, 0, 0, 0) 75%) 100% center;
    background-attachment: scroll, scroll;
    background-color: #fff;
    background-repeat: no-repeat;
    background-size: em( 10 ) 100%, em( 10 ) 100%;
    border: 1px solid palette( default, secondary );
    max-width: 100% !important;        /* 1 */
    -webkit-overflow-scrolling: touch; /* 1 */

    > caption:first-child {
      background-image:
        linear-gradient(
            to left,
            #fff 50%,
            rgba(255, 255, 255, 0) 100%
        ),
        linear-gradient(
            to right,
            #fff 50%,
            rgba(255, 255, 255, 0) 100%
        );
      background-repeat: no-repeat;
      background-position: 100% 0, 0 0;
      background-size: em( 20 ) 100%, em( 20 ) 100%;
      border-bottom: 1px solid palette( default, secondary );
    }
  }

  td:first-child,
  th:first-child {
    background-image: linear-gradient( to right, #fff 50%, rgba(255, 255, 255, 0) 100% );
    background-repeat: no-repeat;
    background-size: em( 20 ) 100%;
  }

  td:last-child,
  th:last-child {
    background-image: linear-gradient( to left, #fff 50%, rgba(255, 255, 255, 0) 100% );
    background-repeat: no-repeat;
    background-position: 100% 0;
    background-size: em( 20 ) 100%;
  }
}

@media only screen and (min-width: em( 768 )) {
  table {
    caption-side: bottom;
    display: table;
    table-layout: fixed;
    width: 100%;
  }

  th,
  td {
    padding: .75em em( 22 );
  }

  tbody th,
  tbody td {
    background: rgba( 255, 255, 255, .5 );
  }

  tbody tr:nth-child(odd) {
    background: palette( default, secondary );
  }
}


/* ==================== */
/* == Buttons
/* ==================== */

/**
 * 1. High contrast mode helper
 ** @see http://fr.slideshare.net/TheZero1/webexpo-highcontrast (slide 11)
 */
button[type] {
  background-color: palette( accent );
  border: 1px solid palette( accent );
  border-radius: $form-border-radius;
  color: $form-button-color;
  font-family: inherit; // Fix typo inputs
  font-size: 1em; // Fix typo inputs
  line-height: $form-line-height;
  margin: .5em 0;
  padding: $form-input-padding;
  vertical-align: middle;
  transition: all 300ms;
  width: auto;
  -webkit-appearance: none;
  -moz-appearance: none;

  &:hover,
  &:focus,
  &:active,
  &[aria-expanded="true"] {
    border: 1px solid rgba( palette( accent ), .75 );
    background-color: rgba( palette( accent ), .75 );
  }

  &:active,
  &[aria-expanded="true"] {
    box-shadow:
      inset 0 2px rgba( 255, 255, 255, .2 ),
      0 .125em 0 -.1em rgba( 0, 0, 0, .15 );
    top: em( 2 );
  }

  &[disabled] {
    &,
    &:hover,
    &:focus,
    &:active {
      background-color: palette( default );
      color: palette( default, secondary );
      cursor: not-allowed;
    }
  }
}


/* ==================== */
/* == Details
/* ==================== */

details {
  border: em( 4 ) solid palette( dominant, dark );
  padding: 1rem;
  
  & + & {
    border-top-width: 0;
  }
  
  &[open] summary ~ * {
    animation: slide-down .5s ease-in-out;
  }
  
  summary {
    background: palette( dominant );
    color: palette( dominant, contrast );
    cursor: pointer;
    margin: -1rem;
    padding: inherit;
    transition: background .2s ease-in-out;
    
    &:hover,
    &:focus {
      background: palette( dominant, dark );
    }
  }
}

@keyframes slide-down {
  0%, 50% {
    opacity: 0;
    transform: translateY(em( 24 ));
  }
}

@media screen and (min-width: em(480)) {
  /**
   * @note Writing-mode
   ** 1. For everyone except Firefox
   ** 2. Firefox is the only one supporting the nicer value
   * @link https://developer.mozilla.org/fr/docs/Web/CSS/writing-mode#Compatibilité_des_navigateurs
   */
   @supports (--foo: bar, baz) {
    .vertical {
      display: flex;
      
      details {
        flex: 0;
        min-width: em( 56 );
        overflow: hidden;
        
        &[open] {
          flex: 1;
          
          summary ~ * {
            animation: slide-in .5s ease-in-out;
          }
        }
        
        & + details {
          border-width: em( 4 ) em( 4 ) em( 4 ) 0;
        }
        
        summary {
          float: left;
          min-height: em( 320 );
          writing-mode: vertical-lr; /* 1 */
          writing-mode: sideways-lr; /* 2 */
          
          ~ * {        
            padding-left: em( 56 );
            
            > *:first-child {
              margin-top: 0;
            }
          }
        }
      }
    }
  }
}

@keyframes slide-in {
  0%, 50% {
    opacity: 0;
    transform: translateX(em( -24 ));
  }
}


/* ==================== */
/* == Grid
/* ==================== */

/* -------------------- */
/* -- Columns
 *
 * @note Avoiding break inside children isn't so well supported
 * @see https://caniuse.com/#search=break-inside
/* -------------------- */
[class*="grid"] > *,
[class*="columns"] > * {
  display: block;
  margin-bottom: $gutter;
}

@media screen and (min-width: em(480)) {
  [class*="grid"],
  [class*="columns"] {
    column-gap: $gutter;
    
    > * {
      page-break-inside: avoid; /* 1 */
      break-inside: avoid;      /* 1 */
    }
  }

  @each $number in 2, 3, 4 {
    .grid-#{$number},
    .columns-#{$number} {
      columns: $number;
    }
  }
  
  /* -------------------- */
  /* -- Fixed grid
  /* -------------------- */
  @supports (display: grid) {
    [class*="grid"] {
      display: grid;
      grid-gap: $gutter;
      
      > * {
        margin: 0;
      }
    }

    @each $number in 2, 3, 4 {
      .grid-#{$number} {
        grid-template-columns: repeat(#{$number}, [col] 1fr);
      }
    }

    .grid-1-2 {
      grid-template-columns: 1fr 2fr;
    }

    .grid-1-3 {
      grid-template-columns: 1fr 3fr;
    }
  }
}


/* ==================== */
/* == Forms
/* ==================== */

form > * + * {
  margin-top: em( 32 );
}

[type="radio"]:not(:first-of-type),
[type="checkbox"]:not(:first-of-type) {
  margin-left: em( 8 );
}


/* ==================== */
/* == Layout
/* ==================== */
body > * {
  background: transparentize( palette( default, secondary ), .25 );
  margin: 0 auto;
  
  @if $full-width == false {
    max-width: $width;
  }
  
  padding: 1rem;
}

/* ----------------------------- */
/* -- Navigation
/* ----------------------------- */

nav ul {
  display: flex;
  list-style: none;
  padding: 0;
}

nav a {
  padding: em( 8 ) em( 16 );
}

/* ----------------------------- */
/* -- Header
/* ----------------------------- */

header[role="banner"] {

}

/* ----------------------------- */
/* -- Footer
/* ----------------------------- */

footer[role="contentinfo"] {

}


/* ==================== */
/* == Components
/* ==================== */

@import "components/footnotes";
@import "components/tooltips";
@import "components/alerts";
@import "components/cards";
@import "components/charts";
@import "components/fly-out";
